---
title: "R Notebook"
output: html_notebook
---



```{r}
ctrl <- trainControl(method = "repeatedcv",
                     number = 5,
                     classProbs = TRUE,
                     summaryFunction = multiClassSummary,
                     sampling = NULL,
                     verboseIter = TRUE)

# Calculate class weights for use in the model
class_weights <- table(train_df[["home_team_result"]]) %>% prop.table() %>% as.data.frame() %>% 
    setNames(c("class", "weight")) %>%
    mutate(weight = 1/weight) %>% 
    deframe()

# The new big loop
cv <- train(x = train_df %>% select(-home_team_result) %>% as.data.frame(),
            y = train_df[["home_team_result"]],
            method = "rf",
            metric = "Kappa",
            trControl = ctrl,
            tuneGrid = expand.grid(mtry = 1:((ncol(train_df) - 1))),
            weights = class_weights)
```



